(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[127],{5007:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return k}});var n=a(5893),i=a(7294),s=a(6991),r=a.n(s),l=a(4105);let o=e=>{let t=Number(e);return t>1e3?(t/1e3).toPrecision(3)+"k":Number.isInteger(t)?t:t>1?t.toPrecision(3):t.toFixed(2)},c=e=>{let{value:t=0,label:a=0,race:i=""}=e,s=Math.ceil(t),r={height:"".concat(100*s-100*t,"%")};return(0,n.jsx)("div",{className:"icon-chart-data",children:s>0?Array(s).fill(0).map((e,t)=>(0,n.jsxs)("div",{className:"icon-chart-data-point",children:[(0,n.jsx)("svg",{"aria-label":"Person",className:"icon-person re-".concat(i),title:s,children:(0,n.jsx)("use",{href:"/images/sprites.svg#person"})}),(0,n.jsx)("span",{className:"icon-chart-data-point-mask",style:s-1===t?r:{},children:s-1===t&&(0,n.jsx)("div",{className:"icon-chart-data-label",children:o(a)})})]},t)):(0,n.jsxs)("div",{className:"icon-chart-data-point",children:[(0,n.jsx)("div",{className:"icon-person icon-person-placeholder"}),(0,n.jsx)("span",{className:"icon-chart-data-point-mask",children:(0,n.jsx)("div",{className:"icon-chart-data-label",children:a>0?o(a):"N/A"})})]})})},d={n_a:"A displayed value of N/A indicates there are 10 or fewer underlying observations for at least one of the variables needed to compute the metric.",zero:"A displayed value of 0.00 means that sufficient data is available, but the value is less than 0.005.",pep:"No rate per prior event information is available for arrests because arrests are the beginning of the process."},p={RAW:"Raw numbers",RATE:"Rate per population",R_PEP:"Rate per prior event point",DG:"Disparity gap per population",DG_PEP:"Disparity gap per prior event point"},u={100:10,500:50,1e3:100,5e3:500,1e4:1e3,5e4:5e3,1e5:1e4,5e5:5e4,1e6:1e5,5e6:5e5,1e7:1e6},h=e=>{let t=0;e.forEach(e=>{let{items:a}=e;t=Math.max(...Object.values(a),t)});let a=1;for(;t*a<1;)a*=10;return 1/a},m=e=>{let t=0;e.forEach(e=>{let{items:a}=e;t=Math.max(...Object.values(a),t)});let a=Object.keys(u).map(e=>parseInt(e,10)).concat([t]);return u["".concat(a[a.sort((e,t)=>e-t).indexOf(t)+1])]},v=e=>{let{yearData:t,races:a,eventPoints:i,base:s,measurement:r}=e,l={n_a:!1,zero:!1,pep:r.indexOf("prior event point")>-1},o=1;r===p.RAW?o=m(t.data):r===p.RATE&&(o=h(t.data));let u=Object.keys(a).filter(e=>e.toLowerCase()!==s),v=i.filter(e=>!([p.R_PEP,p.DG_PEP].includes(r)&&"Arrest"===e)),x={};v.forEach(e=>{let a=t.data.filter(t=>t.label==e);if(0===a.length){l.n_a=!0,x[e]=u.reduce((e,t)=>(e[t]={scaled:0,origin:0},e),{});return}let n=a[0];x[e]=u.reduce((e,t)=>{if(!(t in n.items))return l.n_a=!0,e[t]={scaled:0,origin:0},e;let a=n.items[t];o<1&&(a/=o);let i=(n.items[t]/o).toFixed(2);return a<.005&&a>0&&(l.zero=!0),e[t]={scaled:i,origin:a},e},{})});let f=o.toLocaleString(),j="";return o<1&&(f="1",j="per "+(1/o*100).toLocaleString()),(0,n.jsxs)("div",{className:"icon-chart",children:[(0,n.jsxs)("h3",{children:[t.year,(0,n.jsx)("div",{className:"chart-meta",children:(0,n.jsxs)("div",{className:"chart-scale",children:[(0,n.jsx)(c,{value:1,race:s})," ",f," ",s?"White Adult":o>1?"Adults":"Adult"," ",j]})})]}),(0,n.jsx)("div",{className:"icon-chart-races-container",children:u.map(e=>(0,n.jsxs)("div",{className:"icon-chart-race-container",children:[(0,n.jsx)("h4",{children:a[e]}),(0,n.jsxs)("div",{className:"icon-chart-rows",children:[s&&(0,n.jsx)("div",{className:"icon-chart-row",children:(0,n.jsx)(c,{value:1,race:s,label:1})}),v.map((t,a)=>{var i,s;return(0,n.jsxs)("div",{className:"icon-chart-row",children:[(0,n.jsx)("div",{className:"icon-chart-label",children:t}),(0,n.jsx)(c,{value:null===(i=x[t][e])||void 0===i?void 0:i.scaled,race:e,label:null===(s=x[t][e])||void 0===s?void 0:s.origin})]},a)})]})]},e))}),(0,n.jsx)("div",{children:Object.keys(l).filter(e=>l[e]).map(e=>(0,n.jsx)("p",{className:"icon-chart-disclaimer",children:d[e]}))})]},t.year)},x=e=>{let{data:t,races:a,eventPoints:i,base:s,measurement:r}=e;return(0,n.jsx)("div",{className:"icon-charts",children:t.map((e,t)=>(0,n.jsx)(v,{yearData:e,races:a,eventPoints:i,base:s,measurement:r},t))})},f=["county","PC_code","PC_offense","Race","Year","Event Point","Raw numbers","Rate per population","Rate per prior event point","Disparity gap per population","Disparity gap per prior event point"];var j=e=>{let{data:t}=e,[a,s]=(0,i.useState)(1),r=(a-1)*20,l=r+20,o=t.slice(r,l);return(0,n.jsxs)("div",{className:"table-container",children:[(0,n.jsxs)("table",{className:"ui celled table",children:[(0,n.jsx)("thead",{children:(0,n.jsx)("tr",{children:f.map(e=>(0,n.jsx)("th",{children:e},e))})}),(0,n.jsx)("tbody",{children:o.map((e,t)=>(0,n.jsx)("tr",{children:f.map(t=>{"county"===t&&console.log(e[t]);let a=e[t];return"Raw numbers"===t&&a<10?a="N/A":["Rate per population","Rate per prior event point","Disparity gap per population","Disparity gap per prior event point"].indexOf(t)>-1&&(a=parseFloat(a).toFixed(2)),(0,n.jsx)("td",{children:a},t)})},t))})]}),(0,n.jsxs)("div",{className:"pagination-controls",children:[(0,n.jsx)("button",{className:"pagination-button",onClick:()=>{a>1&&s(a-1)},disabled:1===a,children:"Previous"}),(0,n.jsxs)("span",{children:["Page ",a]}),(0,n.jsx)("button",{className:"pagination-button",onClick:()=>{a<Math.ceil(t.length/20)&&s(a+1)},disabled:a===Math.ceil(t.length/20),children:"Next"})]})]})},b=e=>{let{label:t,value:a=null,options:s=[],multiple:r=!1,disableAll:l=!1,onChange:o=()=>{}}=e,[c,d]=(0,i.useState)(!1),[p,u]=(0,i.useState)(!1),[h,m]=(0,i.useState)(""),v=(0,i.useRef)(null),x=t.toLowerCase().replace(/\s+/g,"-"),f=e=>{let t;t=r?a.includes(e)?a.filter(t=>t!==e):[...a,e]:a===e?null:e,d(r&&t.sort().join(".")===s.map(e=>e.value).sort().join(".")),o(t)};(0,i.useEffect)(()=>{function e(e){!v.current||v.current.contains(e.target)||v.current.parentNode.contains(e.target)||u(!1)}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[v]);let j=s.filter(e=>String(e.text).toLowerCase().includes(h.toLowerCase()));return(0,n.jsxs)("div",{className:"select-component select-component-".concat(x),children:[(0,n.jsxs)("label",{onClick:()=>{d(r&&a.sort().join(".")===s.map(e=>e.value).sort().join(".")),u(!p)},className:p?"modal-actived":"",children:[t," ▼"]}),p&&(0,n.jsxs)("div",{ref:v,className:"modal-wrapper",children:[(0,n.jsx)("h3",{children:t}),"Offenses"===t&&(0,n.jsxs)("div",{className:"search-bar-container",children:[(0,n.jsx)("input",{type:"text",placeholder:"Search Offenses",value:h,onChange:e=>m(e.target.value),className:"search-bar"}),h&&(0,n.jsx)("div",{className:"clear-icon",onClick:()=>m(""),children:"✕"})]}),(0,n.jsxs)("ul",{className:"modal-".concat(x),children:[r&&!l&&(0,n.jsxs)("li",{onClick:()=>{c?o([]):o(s.map(e=>e.value)),d(!c)},children:[(0,n.jsx)("input",{type:"checkbox",checked:c}),"All"]}),j.map(e=>(0,n.jsxs)("li",{onClick:()=>f(e.value),children:[(0,n.jsx)("input",{type:"checkbox",checked:r?a.includes(e.value):a===e.value})," ",e.text]},e.text))]})]})]})},g=a(2729),y=a(508);function N(){let e=(0,g._)(["\n  0%, 100% {\n    opacity: 1;\n  }\n  50% {\n    opacity: 0.5;\n  }\n"]);return N=function(){return e},e}function P(){let e=(0,g._)(["\n  display: inline-block;\n  position: relative;\n  width: ",";\n  height: ",";\n\n  div {\n    position: absolute;\n    width: 18px;\n    height: 18px;\n    border-radius: 50%;\n    background: ",";\n    animation: "," 1.2s linear infinite;\n  }\n\n  div:nth-child(1) {\n    top: 0px;\n    left: -1px;\n    animation-delay: 0s;\n  }\n  div:nth-child(2) {\n    top: 0px;\n    left: 22px;\n    animation-delay: -0.4s;\n  }\n  div:nth-child(3) {\n    top: 0px;\n    left: 45px;\n    animation-delay: -0.8s;\n  }\n  div:nth-child(4) {\n    top: 22px;\n    left: -1px;\n    animation-delay: -0.4s;\n  }\n  div:nth-child(5) {\n    top: 22px;\n    left: 22px;\n    animation-delay: -0.8s;\n  }\n  div:nth-child(6) {\n    top: 22px;\n    left: 45px;\n    animation-delay: -1.2s;\n  }\n  div:nth-child(7) {\n    top: 44px;\n    left: -1px;\n    animation-delay: -0.8s;\n  }\n  div:nth-child(8) {\n    top: 44px;\n    left: 22px;\n    animation-delay: -1.2s;\n  }\n  div:nth-child(9) {\n    top: 44px;\n    left: 45px;\n    animation-delay: -1.6s;\n  }\n"]);return P=function(){return e},e}let w=e=>(0,y.F4)(N()),R=y.ZP.div(P(),e=>"".concat(e.size).concat(e.sizeUnit),e=>"".concat(e.size).concat(e.sizeUnit),e=>e.color,e=>w(e)),_=e=>{let{color:t,size:a,sizeUnit:i}=e;return(0,n.jsxs)(R,{color:t,size:a,sizeUnit:i,children:[(0,n.jsx)("div",{}),(0,n.jsx)("div",{}),(0,n.jsx)("div",{}),(0,n.jsx)("div",{}),(0,n.jsx)("div",{}),(0,n.jsx)("div",{}),(0,n.jsx)("div",{}),(0,n.jsx)("div",{}),(0,n.jsx)("div",{})]})};_.defaultProps={size:64,color:"#9dbcdb",sizeUnit:"px"};let C={RAW:"Raw numbers",RATE:"Rate per population",R_PEP:"Rate per prior event point",DG:"Disparity gap per population",DG_PEP:"Disparity gap per prior event point"},E={"Raw numbers":"Raw numbers","Rate per population":"Rate per unit population","Rate per prior event point":"Rate per prior decision point","Disparity gap per population":"Disparity gap vs. white adults","Disparity gap per prior event point":"Disparity gap per prior decision point"},A={White:"White",Black:"Black",Hispanic:"Latino",AAPI:"Asian / Pacific Islander","Native American":"Native American"},O=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location.href,a=e.replace(/[[]]/g,"\\$&"),n=new RegExp("[?&]".concat(a,"(=([^&#]*)|&|#|$)")),i=n.exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null};function k(){let[e,t]=(0,i.useState)([]),[a,s]=(0,i.useState)(!0),[o,c]=(0,i.useState)([]),[d,p]=(0,i.useState)(["All Counties","County 1","County 2","County 3","County 4","County 5"]),[u,h]=(0,i.useState)("All Counties"),[m,v]=(0,i.useState)([]),[f,g]=(0,i.useState)([]),[y,N]=(0,i.useState)([]),[P,w]=(0,i.useState)([]),[R,k]=(0,i.useState)([]),[D,S]=(0,i.useState)(Object.keys(A)),[Y,z]=(0,i.useState)("Raw numbers"),[L,F]=(0,i.useState)({ratio:1,base:null}),[W,M]=(0,i.useState)([]),[U,G]=(0,i.useState)({raw:[],chart:[]}),[I,T]=(0,i.useState)(!1),B=function(e){let{decisionPoints:t,races:a,offenses:n,years:i,measurement:s}=e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:W,l=["Charge","Conviction","Prison sentence","Felony conviction"],o=r.filter(e=>!!((!(s.indexOf("prior event point")>-1)||l.includes(e["Event Point"]))&&(!(a.length>0)||a.includes(e.Race))&&(!(t.length>0)||t.includes(e["Event Point"]))&&(!(n.length>0)||n.includes(e.Offenses))&&i.includes(e.Year))),c=o.reduce((e,t)=>(e[t.Year]||(e[t.Year]={year:t.Year,data:{}}),e[t.Year].data[t["Event Point"]]||(e[t.Year].data[t["Event Point"]]={label:t["Event Point"],items:{},records:{}}),e[t.Year].data[t["Event Point"]].items[t.Offenses]||(e[t.Year].data[t["Event Point"]].items[t.Offenses]={label:t.Offenses,items:{}}),e[t.Year].data[t["Event Point"]].items[t.Offenses].items[t.Race]=t[s]||0,e[t.Year].data[t["Event Point"]].records[t.Race]?e[t.Year].data[t["Event Point"]].records[t.Race]++:e[t.Year].data[t["Event Point"]].records[t.Race]=1,e),{});G({raw:o,chart:Object.values(c).map(e=>(e.data=Object.values(e.data).map(e=>(e.items=Object.values(e.items).reduce((e,t)=>(Object.keys(t.items).forEach(a=>{a in e||(e[a]=0);let n=e[a]+(t.items[a]||0);return"Raw numbers"===s&&(n=Math.ceil(n)),e[a]=n,e}),e),{}),e)),e))})},H=async(e,a)=>{s(!0);let n=new(r());n.parse("1mo1CvXXVMoyFDciUwvoNI_0T6LwB5Yl2U4Q6COd_0JI",e).then(e=>{let n=[],i=[],r=[],l=[],d=e.map(e=>(e.Offenses=e.PC_offense,e.Race=e.race,e.Year=e.year,e["Event Point"]=e.decision,e["Raw numbers"]=e.number,e["Rate per population"]=isNaN(e.rate_per_100_pop)?0:e.rate_per_100_pop,e["Rate per prior event point"]=isNaN(e.rate_cond_previous)?0:e.rate_cond_previous/100,e["Disparity gap per population"]=isNaN(e.disparity_gap_pop_w)?0:e.disparity_gap_pop_w,e["Disparity gap per prior event point"]=isNaN(e.disparity_gap_cond_w)?0:e.disparity_gap_cond_w,e));d.forEach(e=>{-1===n.indexOf(e.Year)&&n.push(e.Year),-1===i.indexOf(e["Event Point"])&&i.push(e["Event Point"]),-1===r.indexOf(e.Offenses)&&r.push(e.Offenses),-1===l.indexOf(e.Race)&&l.push(e.Race)}),n=n.reverse().sort((e,t)=>"All Years (2010-2021)"===e?-1:"All Years (2010-2021)"===t?1:"2010-2021"===e?-1:"2010-2021"===t?1:t-e),M(d);let p=n[0],u="459 PC-BURGLARY";t([...n]),v([...i]),N([...r]),k([...l]),a?(n=[p],r=[u]):(n=o.filter(e=>n.includes(e)),i=f.filter(e=>i.includes(e)),r=r.includes(P[0])?[P[0]]:[u],l=D.filter(e=>l.includes(e))),c([...n]),g([...i]),w([...r]),S([...l]),B({decisionPoints:i,races:l,offenses:r,years:n,measurement:Y},d),s(!1)})};(0,i.useEffect)(()=>{let e=O("sheet")||"All Counties";H(e,!0).catch(e=>{})},[]);let J=async e=>{h(e),await H(e,!1),B({decisionPoints:f,races:D,offenses:P,years:o,measurement:Y})};return(0,n.jsxs)("div",{className:"tool",id:"tool",children:[(0,n.jsxs)("p",{className:"generic-page",children:["This site provides a dummy data version of a tool that we wiil be launching (pending approval from the California Department of Justice) that will provide summary data representing the raw numbers, rates per population, and disparity gaps by race of adults in the California criminal justice system using data provided by the CalDOJ and Census Department. To be notified when the tool becomes live, please email us at"," ",(0,n.jsx)("a",{href:"mailto:rja@paperprisons.org?subject=Feedback%20for%20Your%20App",children:"rja@paperprisons.org"}),", comments or feedback on the tool’s design welcome too."]}),(0,n.jsxs)("div",{className:"filters",children:[(0,n.jsx)("div",{children:"Customize: "}),(0,n.jsx)("div",{className:"filter",children:(0,n.jsx)(b,{label:"Years",multiple:!0,disableAll:!0,value:o,onChange:e=>{c(e),B({decisionPoints:f,races:D,offenses:P,years:e,measurement:Y})},options:e.map(e=>({text:e,value:e}))})}),(0,n.jsx)("div",{className:"filter",children:(0,n.jsx)(b,{label:"Counties",value:u,multiple:!1,onChange:J,options:d.map(e=>({text:e,value:e}))})}),(0,n.jsx)("div",{className:"filter",children:(0,n.jsx)(b,{label:"Event Point",multiple:!0,value:f,onChange:e=>{g(e),0===e.length?G({raw:[],chart:[]}):B({decisionPoints:e,races:D,offenses:P,years:o,measurement:Y})},options:m.map(e=>({text:e,value:e}))})}),(0,n.jsx)("div",{className:"filter",children:(0,n.jsx)(b,{label:"Race",multiple:!0,value:D,onChange:e=>{S(e),0===e.length?G({raw:[],chart:[]}):B({decisionPoints:f,races:e,offenses:P,years:o,measurement:Y})},options:R.map(e=>({text:e,value:e}))})}),(0,n.jsx)("div",{className:"filter",children:(0,n.jsx)(b,{label:"Offenses",value:P,multiple:!1,onChange:e=>{e&&0!==e.length&&(w(e),B({decisionPoints:f,races:D,offenses:e,years:o,measurement:Y}))},options:y.map(e=>({text:e,value:e}))})}),(0,n.jsx)("div",{className:"filter",children:(0,n.jsx)(b,{label:"Measurement",value:Y,onChange:e=>{e?(z(e),e===C.DG||e===C.DG_PEP?F({base:"white",ratio:.01}):e===C.RAW?F({base:null,ratio:1}):F({base:null,ratio:.1}),B({decisionPoints:f,races:D,offenses:P,years:o,measurement:e})):(z(C.RAW),F({base:null,ratio:1}),B({decisionPoints:f,races:D,offenses:P,years:o,measurement:C.RAW}))},options:Object.keys(E).map(e=>({text:e,value:e}))})})]}),(0,n.jsxs)("div",{className:"chart-selected",children:[(0,n.jsx)("p",{children:(0,n.jsx)("strong",{children:"Demo Only - Populated with Fictitious Data"})}),(0,n.jsx)("h2",{children:(0,n.jsx)("h2",{children:u})}),(0,n.jsx)("p",{dangerouslySetInnerHTML:{__html:[E[Y],f.length===m.length?"All Event Points":f.join(", "),o.length===e.length?"All Years":o.join(", "),D.length===R.length?"All Races":D.join(", "),"".concat(P)].filter(e=>!!e).map(e=>"<span>".concat(e,"</span>")).join(";")}})]}),(0,n.jsx)("div",{className:"chart-containers",children:a?(0,n.jsx)("div",{className:"loading-animation-centered",children:(0,n.jsx)(_,{})}):U.chart.length>0?(0,n.jsx)(x,{data:U.chart,races:Object.fromEntries(Object.entries(A).filter(e=>{let[t]=e;return D.includes(t)})),eventPoints:f,base:L.base,measurement:Y}):(0,n.jsxs)("div",{style:{textAlign:"center",fontWeight:"bold"},children:[(0,n.jsx)("p",{children:"Unable to display due to insufficient data."}),0===o.length&&(0,n.jsx)("p",{children:"Select at least one year."}),0===f.length&&(0,n.jsx)("p",{children:"Select at least one event point."}),0===D.length&&(0,n.jsx)("p",{children:"Select at least one race."})]})}),(0,n.jsxs)("div",{className:"buttons",children:[(0,n.jsx)("div",{className:"button",onClick:()=>window&&window.print(),children:"Print"}),(0,n.jsx)("div",{className:"button",onClick:()=>{T(!I)},children:I?"Hide Table":"View Data"}),(0,n.jsx)("div",{className:"button",onClick:()=>{let e=l.P6.json_to_sheet(U.raw),t=l.P6.book_new();l.P6.book_append_sheet(t,e,"Data"),(0,l.Fv)(t,"PaperPrison - Data.xlsx")},children:"Download Data"})]}),I&&U.raw.length>0&&(0,n.jsx)(j,{data:U.raw})]})}},67:function(){},2061:function(){}}]);